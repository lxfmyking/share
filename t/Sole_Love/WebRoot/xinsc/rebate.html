<!DOCTYPE html>
<html>
<head>
    <title>积分</title>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">
    <link rel="stylesheet" type="text/css" href="css/rebate.css">
    <script type="text/javascript" src="js/hidden.js"></script>
    <script type="text/javascript" src="js/jquery-1.9.1.js"></script>
    <script type="text/javascript" src="js/rebate.js"></script>
	<script type="text/javascript">
	 	$(document).ready(function() {
			$("#year").val(new Date().getFullYear());
			$("#yearTotle").html($("#year").val());
			var url = 'yearDiscounts.action';
			var params = {
				year : $("#year").val(),
			}
			$.post(url, //服务器要接受的url  
			params, //传递的参数       
			function cbf(data) {
				var member = eval("(" + data + ")");
				var score=0;
				if(member!=""){
					for(var i=0;i<member.length;i++){
						score+=member[i].amount;
					}
					$("#score").html("￥"+score);
				}else{
					$("#score").html("￥0");
				}
			}, 'json' //数据传递的类型  json  
			);
			
			var url1 = 'discounts.action';
			var theMonth=new Date().getMonth();
				var params1 = {
					month : theMonth+1,
				}
				$.post(url1, //服务器要接受的url  
				params1, //传递的参数       
				function cbf(data) {
					var member = eval("(" + data + ")");
					var score=0;
					if(member!=""){
						for(var i=0;i<member.length;i++){
							score+=member[i].amount;
						}
						$("#monthScore").html("￥"+score);
					}else{
						$("#monthScore").html("￥0");
					}
				}, 'json' //数据传递的类型  json  
				);
			
		});
	
	$(document).ready(function() {
		$("#p").click(function() {
		var yy=$("#year").val();
			$("#yearTotle").html(++yy);
			var url = 'yearDiscounts.action';
			var params = {
				year : $("#yearTotle").html(),
			}
			$.post(url, //服务器要接受的url  
			params, //传递的参数       
			function cbf(data) {
				var member = eval("(" + data + ")");
				var score=0;
				if(member!=""){
					for(var i=0;i<member.length;i++){
						score+=member[i].amount;
					}
					$("#score").html("￥"+score);
				}else if(member==""){
					$("#score").html("￥0");
				}
			}, 'json' //数据传递的类型  json  
			);
		});
	});
	
	$(document).ready(function() {
		$("#m").click(function() {
			$("#yearTotle").html($("#year").val()-1);
			var url = 'yearDiscounts.action';
			var params = {
				year : $("#yearTotle").html(),
			}
			$.post(url, //服务器要接受的url  
			params, //传递的参数       
			function cbf(data) { //服务器返回后执行的函数 参数 data保存的就是服务器发送到客户端的数据  
				var member = eval("(" + data + ")");
				var score=0;
				if(member!=""){
					for(var i=0;i<member.length;i++){
						score+=member[i].amount;
					}
					$("#score").html("￥"+score);
				}else if(member==""){
					$("#score").html("￥0");
				}
			}, 'json' //数据传递的类型  json  
			);
		});
	});	
	$(document).ready(function(){
	    var ul = document.getElementById('parent');
		var lis = ul.getElementsByTagName('li');
	     for(var i=0;i<lis.length;i++){
	    	lis[i].onclick = function(){
	        	$("#monthValue").val(this.innerHTML);
	        	var url = 'discounts.action';
				var params = {
					month : this.innerHTML,
				}
				$.post(url, //服务器要接受的url  
				params, //传递的参数       
				function cbf(data) {
					var member = eval("(" + data + ")");
					var score=0;
					if(member!=""){
						for(var i=0;i<member.length;i++){
							score+=member[i].amount;
						}
						$("#monthScore").html("￥"+score);
					}else{
						$("#monthScore").html("￥0");
					}
				}, 'json' //数据传递的类型  json  
				);
    		}
		}
		 var ul2 = document.getElementById('parent2');
		 var lis2 = ul2.getElementsByTagName('li');
	     for(var i=0;i<lis2.length;i++){
	    	lis2[i].onclick = function(){
	        	$("#monthValue").val(this.innerHTML);
	        	var url = 'discounts.action';
				var params = {
					month : this.innerHTML,
				}
				$.post(url, //服务器要接受的url  
				params, //传递的参数       
				function cbf(data) {
					var member = eval("(" + data + ")");
					var score=0;
					if(member!=""){
						for(var i=0;i<member.length;i++){
							score+=member[i].amount;
						}
						$("#monthScore").html("￥"+score);
					}else{
						$("#monthScore").html("￥0");
					}
				}, 'json' //数据传递的类型  json  
				);
    		}
		}
	})
	</script>
</head>
<body>
<div class="big_title">
    <span style="color: #898989;"><span id="yearTotle"></span>积分总和</span>&nbsp;&nbsp;<span style="color: #f26c4f" id="score"></span>
</div>
<div class="bg">
    <div class="container">
        <div class="green_div">
            <table style="margin: 0 auto;">
                <tr>
                    <td class="btn1"><a href="javaScript:;" onclick="minus()"><img style="width: 1.5em" src="images/jifen_1.jpg" id="m"></a></td>
                    <td>&nbsp;&nbsp;<input id="year"   readonly="readonly">&nbsp;&nbsp;</td>
                    <td class="btn2"><a href="javaScript:;" onclick="plus()"><img  style="width: 1.5em" src="images/jifen_2.jpg" id="p"></a></td>
                </tr>
            </table>
        </div>
        <div class="contents">
            <div style="padding-right: 10px;padding-left: 10px">
                <div style="width: 100%;text-align: center;margin-bottom: 8px">
                    <ul style="display: inline-block;margin: 0;padding: 0;" id="parent">
                        <li>1</li>
                        <li>2</li>
                        <li>3</li>
                        <li>4</li>
                        <li>5</li>
                        <li>6</li>
                    </ul>
                </div>
               <div style="width: 100%;text-align: center;margin-bottom:1.5em ">
                <ul style="display: inline-block;margin: 0;padding: 0" id="parent2">
                    <li>7</li>
                    <li>8</li>
                    <li>9</li>
                    <li>10</li>
                    <li>11</li>
                    <li>12</li>
                </ul>
               </div>
            </div>
        </div>
    </div>
    <div style="font-size: 1.5em;text-align: center;margin-top: 0.8em;margin-bottom: 0.8em;color: #898989">当月积分&nbsp;<span style="color: #f26c4f" id="monthScore"></span></div>
    <div class="container">
        <div class="white_div">
            <span style="font-size: 1.5em;color:#898989">礼品兑换</span>
        </div>
        <div style="padding-right: 10px;padding-left: 10px;padding-top: 20px;margin-bottom: 20px">
            <div style="width: 100%;height:73px;">
                <div style="float: left"><img style="width: 70px;height: 71px" src="./images/tiepishihu.png"></div>
                <div style="float: right;width: 70%;height: 71px;margin-top: 1em">
                    <div style="float: left;color: #868686;"><span style="font-size: 1em">首草公仔</span><br><span style="font-size: 0.8em;">需要<span style="color:#f26c4f ">3000</span>积分</span></div>
                    <div style="float: right;"><input type="button" value="兑换" class="sub_btn"></div>
                </div>
           </div>
        </div>
        <div style="width: 100%;border-bottom: 1px solid #ececec"></div>
        <div style="padding-right: 10px;padding-left: 10px;padding-top: 20px;margin-bottom: 20px">
            <div style="width: 100%;height:73px;">
                <div style="float: left"><img style="width: 70px;height: 71px" src="./images/tiepishihu.png"></div>
                <div style="float: right;width: 70%;height: 71px;margin-top: 1em">
                    <div style="float: left;color: #868686;"><span style="font-size: 1em">首草公仔</span><br><span style="font-size: 0.8em;">需要<span style="color:#f26c4f ">3000</span>积分</span></div>
                    <div style="float: right;"><input type="button" value="兑换" class="sub_btn"></div>
                </div>
            </div>
        </div>
    </div>
</div>

</body>

</html>
